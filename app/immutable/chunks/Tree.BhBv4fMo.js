import{a as i,t as w,c as Q}from"./disclose-version.CBUhcYe9.js";import{p as de,z as T,B as me,v as p,l as be,w as e,D as j,E as ke,C as oe,o as D,A as v,m as d,n as u,F as he,G as ye}from"./runtime.4vCN5gQe.js";import{s as V}from"./render.ZJTH9JWY.js";import{p as _,i as q}from"./if.D3RmbbZj.js";import{e as ge,t as g,i as we}from"./class.CxUNBNxR.js";import{s as I}from"./attributes.s4vI7vNd.js";import{d as xe}from"./events.CYiFnV6R.js";import{b as Ae}from"./this.D9eYfFuq.js";import{p as K,o as Ee}from"./index-client.CJwHoa7I.js";var pe=(m,t,l)=>{t(e(l))},De=w('<li><button class="svelte-e5m94k"> </button></li>'),Ce=(m,t,l)=>{t(e(l))},Be=w('<button class="svelte-e5m94k"> </button> <!>',1),Fe=(m,t,l)=>{t(e(l))},Le=w('<button class="svelte-e5m94k"> </button>'),Te=w("<li><!></li>"),je=w('<ol class="svelte-e5m94k"></ol>'),qe=(m,t,l,x,b,A)=>{t.tree[e(l)].type==="folder"?(e(x).push(e(l)),b()(e(l))):b()(e(A))},Ie=(m,t,l,x,b,A)=>{t.tree[e(l)].type==="folder"?(e(x).push(e(l)),b()(e(l))):b()(e(A))},Ke=(m,t,l)=>{t(e(l))},Me=w('<div class="tree svelte-e5m94k"><div class="controls svelte-e5m94k"><p class="title svelte-e5m94k">My Project</p> <button>+ğŸ“‚</button> <button>+ğŸ“œ</button> <button class="delete-button svelte-e5m94k">-ğŸ—‘ï¸</button></div> <div class="directory svelte-e5m94k"><!></div></div>');function Je(m,t){de(t,!0);const l=(r,F=ke,O)=>{let ee=he(()=>ye(O==null?void 0:O(),0));var te=Q(),ce=j(te);q(ce,()=>F().type==="folder",se=>{var L=je();ge(L,21,()=>F().children,we,(ie,a)=>{var re=Q(),ve=j(re);q(ve,()=>t.tree[e(a)].type==="page",R=>{var y=De(),f=d(y);f.__click=[pe,h,a];var S=d(f);u(f),u(y),p(()=>{I(f,"id",e(a)),g(f,"active",e(E)===e(a)),g(f,"selected",e(o)===e(a)),V(S,`ğŸ“œ ${t.tree[e(a)].name??""}`)}),i(R,y)},R=>{var y=Q(),f=j(y);q(f,()=>t.tree[e(a)].type==="folder",S=>{var H=Te(),ue=d(H);q(ue,()=>e(n).includes(e(a)),J=>{var c=Be(),s=j(c);s.__click=[Ce,h,a];var _e=d(s);u(s);var fe=D(s,2);l(fe,()=>t.tree[e(a)],()=>e(ee)+1),p(()=>{I(s,"id",e(a)),g(s,"active",e(E)===e(a)),g(s,"selected",e(o)===e(a)),V(_e,`ğŸ“‚ ${t.tree[e(a)].name??""}`)}),i(J,c)},J=>{var c=Le();c.__click=[Fe,h,a];var s=d(c);u(c),p(()=>{I(c,"id",e(a)),g(c,"active",e(E)===e(a)),g(c,"selected",e(o)===e(a)),V(s,`ğŸ“ ${t.tree[e(a)].name??""}`)}),i(J,c)}),u(H),i(S,H)},null,!0),i(R,y)}),i(ie,re)}),u(L),p(()=>I(L,"style",`--depth: ${e(ee)??""}`)),i(se,L)}),i(r,te)};let x=K(t,"newFolder",3,()=>{}),b=K(t,"newPage",3,()=>{}),A=K(t,"removeChild",3,()=>{}),ae=K(t,"active",3,!0),n=T(_(["root"])),o=T("root"),E=T("root"),M=oe(()=>{for(const r in t.tree)if(t.tree[r].type==="folder"&&t.tree[r].children.includes(e(o)))return r;return"root"}),P,k=T(_([])),C=oe(()=>e(k).findIndex(r=>r.id===e(o)));me(()=>{e(n).length>0&&Object.keys(t.tree).length>0?v(k,_(Array.from(P.querySelectorAll("button")))):v(k,_([]))});function h(r){v(o,_(r)),v(E,_(r)),t.tree[r].type==="folder"&&(e(n).includes(r)?v(n,_(e(n).filter(F=>F!==r))):e(n).push(r))}function B(){if(e(C)>0){const r=e(k)[e(C)-1];v(o,_(r.id)),r.focus()}}function U(){if(e(C)<e(k).length-1){const r=e(k)[e(C)+1];v(o,_(r.id)),r.focus()}}function le(){console.log("clear focus"),v(o,"root"),v(E,"root"),e(k).forEach(r=>r.blur())}function W(r){confirm("Are you sure you want to delete?")&&(A()(e(M),r),B())}function X(r){if(console.log(),!(!ae()||t.tree.root.type==="folder"&&t.tree.root.children.length<=0))switch(r.key){case"ArrowLeft":e(n).includes(e(o))?h(e(o)):B();break;case"ArrowRight":t.tree[e(o)].type==="folder"&&e(o)!=="root"&&!e(n).includes(e(o))?h(e(o)):U();break;case"ArrowUp":B();break;case"ArrowDown":U();break;case"Enter":r.preventDefault(),h(e(o));break;case"Escape":le();break;case"Tab":r.preventDefault(),r.shiftKey?B():U();break;case"Delete":W(e(o));break}}Ee(()=>(document.addEventListener("keydown",X),()=>{document.removeEventListener("keydown",X)}));var z=Me(),G=d(z),Y=D(d(G),2);Y.__click=[qe,t,o,n,x,M];var Z=D(Y,2);Z.__click=[Ie,t,o,n,b,M];var $=D(Z,2);$.__click=[Ke,W,o],u(G);var N=D(G,2);Ae(N,r=>P=r,()=>P);var ne=d(N);l(ne,()=>t.tree.root),u(N),u(z),p(()=>$.disabled=!e(o)||e(o)==="root"),i(m,z),be()}xe(["click"]);export{Je as T};
