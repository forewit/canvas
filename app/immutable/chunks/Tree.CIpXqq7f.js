import{a as _,t as g,c as H}from"./disclose-version.CBUhcYe9.js";import{p as fe,z as J,B as de,v as p,l as be,w as e,D as L,E as me,C as re,A as i,o as A,m as d,n as u,F as ke,G as he}from"./runtime.4vCN5gQe.js";import{s as N}from"./render.ZJTH9JWY.js";import{p as s,i as T}from"./if.D3RmbbZj.js";import{e as ye,t as Q,i as xe}from"./class.CxUNBNxR.js";import{s as j}from"./attributes.s4vI7vNd.js";import{d as ge}from"./events.CYiFnV6R.js";import{b as we}from"./this.D9eYfFuq.js";import{p as q,o as pe}from"./index-client.CJwHoa7I.js";var Ae=(b,t,o,n)=>{i(t,s(e(o))),n(e(o))},Ee=g('<li><button class="svelte-1x61k52"> </button></li>'),Ce=(b,t,o,n)=>{i(t,s(e(o))),n(e(o))},De=g('<button class="svelte-1x61k52"> </button> <!>',1),Be=(b,t,o,n)=>{i(t,s(e(o))),n(e(o))},Fe=g('<button class="svelte-1x61k52"> </button>'),Le=g("<li><!></li>"),Te=g('<ol class="svelte-1x61k52"></ol>'),je=(b,t,o,n,m,w)=>{t.tree[e(o)].type==="folder"?(e(n).push(e(o)),m()(e(o))):m()(e(w))},qe=(b,t,o,n,m,w)=>{t.tree[e(o)].type==="folder"?(e(n).push(e(o)),m()(e(o))):m()(e(w))},Ie=(b,t,o)=>{t(e(o))},Ke=g('<div class="tree svelte-1x61k52"><div class="controls svelte-1x61k52"><p class="title svelte-1x61k52">My Project</p> <button>+📂</button> <button>+📜</button> <button class="delete-button svelte-1x61k52">-🗑️</button></div> <div class="directory svelte-1x61k52"><!></div></div>');function Je(b,t){fe(t,!0);const o=(a,B=me,z)=>{let $=ke(()=>he(z==null?void 0:z(),0));var ee=H(),ne=L(ee);T(ne,()=>B().type==="folder",se=>{var F=Te();ye(F,21,()=>B().children,xe,(ce,l)=>{var te=H(),ie=L(te);T(ie,()=>t.tree[e(l)].type==="page",G=>{var x=Ee(),h=d(x);h.__click=[Ae,r,l,y];var O=d(h);u(h),u(x),p(()=>{j(h,"id",e(l)),Q(h,"selected",e(r)===e(l)),N(O,`📜 ${t.tree[e(l)].name??""}`)}),_(G,x)},G=>{var x=H(),h=L(x);T(h,()=>t.tree[e(l)].type==="folder",O=>{var R=Le(),ve=d(R);T(ve,()=>e(c).includes(e(l)),S=>{var v=De(),f=L(v);f.__click=[Ce,r,l,y];var _e=d(f);u(f);var ue=A(f,2);o(ue,()=>t.tree[e(l)],()=>e($)+1),p(()=>{j(f,"id",e(l)),Q(f,"selected",e(r)===e(l)),N(_e,`📂 ${t.tree[e(l)].name??""}`)}),_(S,v)},S=>{var v=Fe();v.__click=[Be,r,l,y];var f=d(v);u(v),p(()=>{j(v,"id",e(l)),Q(v,"selected",e(r)===e(l)),N(f,`📁 ${t.tree[e(l)].name??""}`)}),_(S,v)}),u(R),_(O,R)},null,!0),_(G,x)}),_(ce,te)}),u(F),p(()=>j(F,"style",`--depth: ${e($)??""}`)),_(se,F)}),_(a,ee)};let n=q(t,"newFolder",3,()=>{}),m=q(t,"newPage",3,()=>{}),w=q(t,"removeChild",3,()=>{}),ae=q(t,"active",3,!0),c=J(s(["root"])),r=J("root"),E=re(()=>{for(const a in t.tree)if(t.tree[a].type==="folder"&&t.tree[a].children.includes(e(r)))return a;return"root"});function y(a){t.tree[a].type==="folder"&&(e(c).includes(a)?i(c,s(e(c).filter(B=>B!==a))):e(c).push(a))}let C,k=J(s([])),D=re(()=>e(k).findIndex(a=>a.id===e(r)));de(()=>{e(c).length>0&&Object.keys(t.tree).length>0?i(k,s(Array.from(C.querySelectorAll("button")))):i(k,s([]))});function I(){e(D)>0&&i(r,s(e(k)[e(D)-1].id))}function K(){e(D)<e(k).length-1&&i(r,s(e(k)[e(D)+1].id))}function oe(){i(r,"root"),e(k).forEach(a=>a.blur()),C.focus()}function V(a){confirm("Are you sure you want to delete?")&&(w()(e(E),a),i(r,s(e(E))))}function W(a){if(ae())switch(a.key){case"ArrowLeft":e(c).includes(e(r))?y(e(r)):I();break;case"ArrowRight":t.tree[e(r)].type==="folder"&&e(r)!=="root"&&!e(c).includes(e(r))?y(e(r)):K();break;case"ArrowUp":I();break;case"ArrowDown":K();break;case"Enter":y(e(r));break;case"Escape":oe();break;case"Tab":a.preventDefault(),a.shiftKey?I():K();break;case"delete":V(e(r));break}}pe(()=>(document.addEventListener("keydown",W),()=>{document.removeEventListener("keydown",W)}));var M=Ke(),P=d(M),X=A(d(P),2);X.__click=[je,t,r,c,n,E];var Y=A(X,2);Y.__click=[qe,t,r,c,m,E];var Z=A(Y,2);Z.__click=[Ie,V,r],u(P);var U=A(P,2);we(U,a=>C=a,()=>C);var le=d(U);o(le,()=>t.tree.root),u(U),u(M),p(()=>Z.disabled=!e(r)||e(r)==="root"),_(b,M),be()}ge(["click"]);export{Je as T};
