import{a as l,t as b,d as ce,b as I}from"../chunks/disclose-version.C3rfybqw.js";import{e as $e,x as J,n as de,y as x,z as K,ag as F,af as Re,o as e,w,A as _,C as f,D as u,B as C,p as ue,M as Se,au as De}from"../chunks/runtime.s8g5pai7.js";import{s as R}from"../chunks/render.DGs8JWJ0.js";import{B as P,e as Y,i as ee,a as Ie,T as Te}from"../chunks/Toggle.usjeGCjM.js";import{d as Ne}from"../chunks/events.D0zwNnL9.js";import{b as z}from"../chunks/paths.CviGfTIR.js";import{a as Q,s as M,f as qe,g as Ce}from"../chunks/app.svelte.BOHTfwmN.js";import{g as be,b as oe}from"../chunks/directories.svelte.B7rqT7ni.js";import{a as Ze,p as X,i as B}from"../chunks/if.D0pELIQJ.js";import{p as te}from"../chunks/index-client.CBFAeZbm.js";import{l as Oe}from"../chunks/input.CBVZyRr6.js";function xe(o,n,t){if(o.multiple)return Me(o,n);for(var a of o.options){var r=H(a);if(Ze(r,n)){a.selected=!0;return}}(!t||n!==void 0)&&(o.selectedIndex=-1)}function Ae(o,n){$e(()=>{var t=new MutationObserver(()=>{var a=o.__value;xe(o,a)});return t.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function Fe(o,n,t){var a=!0;Oe(o,"change",()=>{var r;if(o.multiple)r=[].map.call(o.querySelectorAll(":checked"),H);else{var i=o.querySelector(":checked");r=i&&H(i)}t(r)}),$e(()=>{var r=n();if(xe(o,r,a),a&&r===void 0){var i=o.querySelector(":checked");i!==null&&(r=H(i),t(r))}o.__value=r,a=!1}),Ae(o)}function Me(o,n){for(var t of o.options)t.selected=~n.indexOf(H(t))}function H(o){return"__value"in o?o.__value:o.value}var Be=b('<li><div class="button svelte-rpge36"><!></div></li>'),je=b('<div class="button svelte-rpge36"><!></div> <!>',1),Ee=b('<div class="button svelte-rpge36"><!></div>'),Ge=b("<li><!></li>"),He=b('<ol class="svelte-rpge36"></ol>'),Je=b('<div class="tree-panel theme-panel svelte-rpge36"><div class="controls svelte-rpge36"><p class="title svelte-rpge36"> </p> <!> <!> <!></div> <div class="directory svelte-rpge36"><!></div></div>');function Ke(o,n){J(n,!0);const t=($,Z=Re,re)=>{let pe=Se(()=>De(re==null?void 0:re(),0));var me=ce(),we=F(me);B(we,()=>Z().type==="folder",ze=>{var V=He();Y(V,21,()=>Z().children,ee,(Ue,h)=>{var _e=ce(),Le=F(_e);B(Le,()=>e(s)[e(h)].type==="page",ae=>{var A=Be(),j=_(A),ne=_(j),E=w(()=>e(g)===e(h)),se=w(()=>e(g)===e(h)?0:void 0);P(ne,{get selected(){return e(E)},get tabindex(){return e(se)},iconURL:`${z??""}/images/icons/font-awesome/feather.svg`,onclick:()=>k(e(h)),children:(G,q)=>{C();var D=I();x(()=>R(D,i[e(s)[e(h)].pageID].title)),l(G,D)},$$slots:{default:!0}}),f(j),f(A),x(()=>M(j,"id",e(h))),l(ae,A)},ae=>{var A=ce(),j=F(A);B(j,()=>e(s)[e(h)].type==="folder",ne=>{var E=Ge(),se=_(E);B(se,()=>e(v).includes(e(h)),G=>{var q=je(),D=F(q),le=_(D),ie=w(()=>e(g)===e(h)),ve=w(()=>e(g)===e(h)?0:void 0);P(le,{get selected(){return e(ie)},get tabindex(){return e(ve)},iconURL:`${z??""}/images/icons/font-awesome/folder-open.svg`,onclick:()=>k(e(h)),children:(W,dt)=>{C();var he=I();x(()=>R(he,e(s)[e(h)].name)),l(W,he)},$$slots:{default:!0}}),f(D);var ge=u(D,2);t(ge,()=>e(s)[e(h)],()=>e(pe)+1),x(()=>M(D,"id",e(h))),l(G,q)},G=>{var q=Ee(),D=_(q),le=w(()=>e(g)===e(h)),ie=w(()=>e(g)===e(h)?0:void 0);P(D,{get selected(){return e(le)},get tabindex(){return e(ie)},iconURL:`${z??""}/images/icons/font-awesome/folder-closed.svg`,onclick:()=>k(e(h)),children:(ve,ge)=>{C();var W=I();x(()=>R(W,e(s)[e(h)].name)),l(ve,W)},$$slots:{default:!0}}),f(q),x(()=>M(q,"id",e(h))),l(G,q)}),f(E),l(ne,E)},null,!0),l(ae,A)}),l(Ue,_e)}),f(V),x(()=>M(V,"style",`--depth: ${e(pe)??""}`)),l(ze,V)}),l($,me)},a=Q(),r=be(),i=oe();let s=w(()=>r.tree),v=de(X(["root"])),c=de("root"),g=de("root"),d=w(()=>{for(const $ in e(s))if(e(s)[$].type==="folder"&&e(s)[$].children.includes(e(c)))return $;return"root"}),p=w(()=>e(s)[e(c)].type==="folder"?e(c):e(d));function k($){e(s)[$].type==="folder"?e(v).includes($)?ue(v,X(e(v).filter(Z=>Z!==$))):e(v).push($):e(s)[$].type==="page"&&(a.currentPageID=e(s)[$].pageID),ue(c,X($)),ue(g,X($))}function m(){confirm("Are you sure you want to delete?")&&r.removeChild(e(d),e(c))}function T($){if(e(v).push(e(p)),$==="folder")r.addSubfolder(e(p));else if($==="page"){const Z=crypto.randomUUID().slice(0,8);i[Z]={lastUpdated:Date.now(),title:"Untitled",content:""},r.addPageID(e(p),Z)}}var S=Je(),L=_(S),y=_(L),U=_(y);f(y);var N=u(y,2);P(N,{iconURL:`${z??""}/images/icons/font-awesome/folder-new.svg`,onclick:()=>T("folder")});var O=u(N,2);P(O,{iconURL:`${z??""}/images/icons/font-awesome/feather.svg`,onclick:()=>T("page")});var ke=u(O,2),Pe=w(()=>!e(c)||e(c)==="root");P(ke,{get disabled(){return e(Pe)},iconURL:`${z??""}/images/icons/font-awesome/trash.svg`,onclick:m}),f(L);var fe=u(L,2),ye=_(fe);t(ye,()=>e(s).root),f(fe),f(S),x(()=>R(U,a.username)),l(o,S),K()}var Qe=b('<div class="page-toolbar theme-toolbar svelte-1xv751g"><!> <!> <!></div>');function Ve(o,n){J(n,!0);let t=te(n,"openTreePanel",3,()=>{}),a=te(n,"openSettingsPanel",3,()=>{});const r=Q(),i=oe();let s=w(()=>i[r.currentPageID]!==void 0?i[r.currentPageID].title:"Untitled");var v=Qe(),c=_(v);P(c,{iconURL:`${z??""}/images/icons/font-awesome/home.svg`,href:`${z??""}/`});var g=u(c,2);P(g,{iconURL:`${z??""}/images/icons/font-awesome/folder-closed.svg`,get onclick(){return a()}});var d=u(g,2);P(d,{get onclick(){return t()},children:(p,k)=>{C();var m=I();x(()=>R(m,e(s))),l(p,m)},$$slots:{default:!0}}),f(v),l(o,v),K()}var We=b("<!> <!> <!>",1),Xe=b('<div class="zoom-toolbar theme-toolbar svelte-16pmxx3"><!></div>');function Ye(o,n){J(n,!0);const t=Q(),a=[.25,.5,.75,1,1.25,1.5,1.75,2];function r(){const d=a.find(p=>p>t.zoom);t.zoom=d!==void 0?d:a[a.length-1]}function i(){const d=a.toReversed().find(p=>p<t.zoom);t.zoom=d!==void 0?d:a[0]}function s(){const d=a.find(p=>p>t.zoom);t.zoom=d!==void 0?d:a[0]}function v(){t.zoom=1}var c=Xe(),g=_(c);B(g,()=>n.variant==="alt",d=>{var p=We(),k=F(p);P(k,{iconURL:`${z??""}/images/icons/font-awesome/zoom-out.svg`,onclick:i});var m=u(k,2);P(m,{onclick:v,children:(S,L)=>{C();var y=I();x(()=>R(y,`${Math.round(t.zoom*100)??""}%`)),l(S,y)},$$slots:{default:!0}});var T=u(m,2);P(T,{iconURL:`${z??""}/images/icons/font-awesome/zoom-in.svg`,onclick:r}),l(d,p)},d=>{P(d,{onclick:s,children:(p,k)=>{C();var m=I();x(()=>R(m,`${Math.round(t.zoom*100)??""}%`)),l(p,m)},$$slots:{default:!0}})}),f(c),l(o,c),K()}var et=b("<option> </option>"),tt=b("<select></select>");function ot(o,n){let t=te(n,"name",3,"Select one"),a=te(n,"value",15);var r=tt();Y(r,21,()=>n.options,ee,(i,s)=>{var v=et(),c={},g=_(v);f(v),x(()=>{c!==(c=e(s))&&(v.value=(v.__value=e(s))==null?"":e(s)),R(g,e(s))}),l(i,v)}),f(r),x(()=>{M(r,"name",t()),M(r,"id",n.id)}),Fe(r,a,i=>a(i)),l(o,r)}var rt=b("<!> <!> <!>",1),at=b('<div class="settings-panel theme-panel svelte-1rflt3x"><!></div>');function nt(o,n){J(n,!0);const t=Q(),a=oe();let r=w(()=>a[t.currentPageID]);var i=at(),s=_(i);B(s,()=>e(r),v=>{var c=rt(),g=F(c);Ie(g,{get value(){return e(r).title},set value(m){e(r).title=m}});var d=u(g,2);Te(d,{get checked(){return t.spellcheck},set checked(m){t.spellcheck=m},id:"spellcheck",children:(m,T)=>{C();var S=I("Spellcheck");l(m,S)},$$slots:{default:!0}});var p=u(d,2),k=w(qe);ot(p,{id:"theme-select",name:"Theme",get options(){return e(k)},get value(){return t.themeName},set value(m){t.themeName=m}}),l(v,c)},v=>{var c=I("Loading...");l(v,c)}),f(i),l(o,i),K()}var st=(o,n,t)=>{delete n.tree[e(t)]},lt=b('<p> <button class="close-page-button">❌</button></p>'),it=(o,n,t)=>{delete n[e(t)]},vt=b('<p> <button class="close-page-button">❌</button></p>'),ct=b('<div class="page-container svelte-1khv4q7"><header></header> <main class="svelte-1khv4q7"><!> <!> <!> <!></main> <footer class="svelte-1khv4q7"><!> <section id="orphaned-folders"><p>Orphaned folders:</p> <!></section> <section id="orphaned-pages"><p>Orphaned pages:</p> <!></section></footer></div>');function Pt(o,n){J(n,!0),Q();const t=oe();Ce();const a=be();var r=ct(),i=u(_(r),2),s=_(i);Ve(s,{});var v=u(s,2);Ye(v,{variant:"alt"});var c=u(v,2);Ke(c,{});var g=u(c,2);nt(g,{}),f(i);var d=u(i,2),p=_(d);P(p,{iconURL:`${z??""}/images/icons/gear.svg`,href:`${z??""}/profile`,children:(L,y)=>{C();var U=I("Settings");l(L,U)},$$slots:{default:!0}});var k=u(p,2),m=u(_(k),2);Y(m,17,()=>a.orphanedFolders,ee,(L,y)=>{var U=lt(),N=_(U),O=u(N);O.__click=[st,a,y],f(U),x(()=>R(N,`💀📁 ${a.tree[e(y)].name??""}`)),l(L,U)}),f(k);var T=u(k,2),S=u(_(T),2);Y(S,17,()=>a.orphanedPages,ee,(L,y)=>{var U=vt(),N=_(U),O=u(N);O.__click=[it,t,y],f(U),x(()=>R(N,`💀📄 ${t[e(y)].title??""}`)),l(L,U)}),f(T),f(d),f(r),l(o,r),K()}Ne(["click"]);export{Pt as component};
