import{a as s,t as k,d as V,b as S}from"../chunks/disclose-version.BlsN6X0a.js";import{f as $e,w as E,a as ce,y as x,z as G,x as q,ai as Re,b as e,d as y,B as $,C as g,A as _,X as I,c as ue,a3 as Se,aw as Te}from"../chunks/runtime.BZ2yvmcy.js";import{s as R}from"../chunks/render.ClryS_dF.js";import{i as Z}from"../chunks/if.B69R1Din.js";import{B as b,e as W,i as Y,a as Ie,T as De}from"../chunks/Toggle.DCBEOQqn.js";import{b as U}from"../chunks/paths.DXh74Bk7.js";import{g as H,b as Ne}from"../chunks/app.svelte.BFvhVt60.js";import{g as te}from"../chunks/pages.svelte.DoMi3FPE.js";import{g as Ce}from"../chunks/firebase.svelte.-uLT7CDo.js";import{g as xe}from"../chunks/directories.svelte.3ItI8oyV.js";import{s as F}from"../chunks/attributes.Dac1tSuF.js";import{i as qe,p as Q}from"../chunks/proxy.Csehax7D.js";import{p as ee}from"../chunks/index-client.GEksk9V3.js";import{l as Ze}from"../chunks/input.DstR4QUx.js";function be(r,l,t){if(r.multiple)return Oe(r,l);for(var a of r.options){var o=j(a);if(qe(o,l)){a.selected=!0;return}}(!t||l!==void 0)&&(r.selectedIndex=-1)}function Ae(r,l){$e(()=>{var t=new MutationObserver(()=>{var a=r.__value;be(r,a)});return t.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function Fe(r,l,t){var a=!0;Ze(r,"change",()=>{var o;if(r.multiple)o=[].map.call(r.querySelectorAll(":checked"),j);else{var i=r.querySelector(":checked");o=i&&j(i)}t(o)}),$e(()=>{var o=l();if(be(r,o,a),a&&o===void 0){var i=r.querySelector(":checked");i!==null&&(o=j(i),t(o))}r.__value=o,a=!1}),Ae(r)}function Oe(r,l){for(var t of r.options)t.selected=~l.indexOf(j(t))}function j(r){return"__value"in r?r.__value:r.value}var Be=k('<li><div class="button svelte-rpge36"><!></div></li>'),Me=k('<div class="button svelte-rpge36"><!></div> <!>',1),Xe=k('<div class="button svelte-rpge36"><!></div>'),je=k("<li><!></li>"),Ee=k('<ol class="svelte-rpge36"></ol>'),Ge=k('<div class="tree-panel theme-panel svelte-rpge36"><div class="controls svelte-rpge36"><p class="title svelte-rpge36"> </p> <!> <!> <!></div> <div class="directory svelte-rpge36"><!></div></div>');function He(r,l){E(l,!0);const t=(h,C=Re,ae)=>{let me=Se(()=>Te(ae==null?void 0:ae(),0));var pe=V(),we=q(pe);Z(we,()=>C().type==="folder",ze=>{var J=Ee();W(J,21,()=>C().children,Y,(Le,p)=>{var ge=V(),Ue=q(ge);Z(Ue,()=>e(n)[e(p)].type==="page",ne=>{var A=Be(),B=$(A),se=$(B),M=y(()=>e(m)===e(p)),le=y(()=>e(m)===e(p)?0:void 0);b(se,{get selected(){return e(M)},get tabindex(){return e(le)},iconURL:`${U??""}/images/icons/font-awesome/feather.svg`,onclick:()=>w(e(p)),children:(X,D)=>{I();var T=S();x(()=>R(T,i[e(n)[e(p)].pageID].title)),s(X,T)},$$slots:{default:!0}}),g(B),g(A),x(()=>F(B,"id",e(p))),s(ne,A)},ne=>{var A=V(),B=q(A);Z(B,()=>e(n)[e(p)].type==="folder",se=>{var M=je(),le=$(M);Z(le,()=>e(v).includes(e(p)),X=>{var D=Me(),T=q(D),ie=$(T),ve=y(()=>e(m)===e(p)),de=y(()=>e(m)===e(p)?0:void 0);b(ie,{get selected(){return e(ve)},get tabindex(){return e(de)},iconURL:`${U??""}/images/icons/font-awesome/folder-open.svg`,onclick:()=>w(e(p)),children:(K,st)=>{I();var he=S();x(()=>R(he,e(n)[e(p)].name)),s(K,he)},$$slots:{default:!0}}),g(T);var _e=_(T,2);t(_e,()=>e(n)[e(p)],()=>e(me)+1),x(()=>F(T,"id",e(p))),s(X,D)},X=>{var D=Xe(),T=$(D),ie=y(()=>e(m)===e(p)),ve=y(()=>e(m)===e(p)?0:void 0);b(T,{get selected(){return e(ie)},get tabindex(){return e(ve)},iconURL:`${U??""}/images/icons/font-awesome/folder-closed.svg`,onclick:()=>w(e(p)),children:(de,_e)=>{I();var K=S();x(()=>R(K,e(n)[e(p)].name)),s(de,K)},$$slots:{default:!0}}),g(D),x(()=>F(D,"id",e(p))),s(X,D)}),g(M),s(se,M)},null,!0),s(ne,A)}),s(Le,ge)}),g(J),x(()=>F(J,"style",`--depth: ${e(me)??""}`)),s(ze,J)}),s(h,pe)},a=H(),o=xe(),i=te();let n=y(()=>o.tree),v=ce(Q(["root"])),d=ce("root"),m=ce("root"),c=y(()=>{for(const h in e(n))if(e(n)[h].type==="folder"&&e(n)[h].children.includes(e(d)))return h;return"root"}),f=y(()=>e(n)[e(d)].type==="folder"?e(d):e(c));function w(h){e(n)[h].type==="folder"?e(v).includes(h)?ue(v,Q(e(v).filter(C=>C!==h))):e(v).push(h):e(n)[h].type==="page"&&(a.currentPageID=e(n)[h].pageID),ue(d,Q(h)),ue(m,Q(h))}function u(){confirm("Are you sure you want to delete?")&&o.removeChild(e(c),e(d))}function P(h){if(e(v).push(e(f)),h==="folder")o.addSubfolder(e(f));else if(h==="page"){const C=crypto.randomUUID().slice(0,8);i[C]={lastUpdated:Date.now(),title:"Untitled",content:""},o.addPageID(e(f),C)}}var z=Ge(),N=$(z),L=$(N),oe=$(L);g(L);var re=_(L,2);b(re,{iconURL:`${U??""}/images/icons/font-awesome/folder-new.svg`,onclick:()=>P("folder")});var O=_(re,2);b(O,{iconURL:`${U??""}/images/icons/font-awesome/feather.svg`,onclick:()=>P("page")});var ke=_(O,2),Pe=y(()=>!e(d)||e(d)==="root");b(ke,{get disabled(){return e(Pe)},iconURL:`${U??""}/images/icons/font-awesome/trash.svg`,onclick:u}),g(N);var fe=_(N,2),ye=$(fe);t(ye,()=>e(n).root),g(fe),g(z),x(()=>R(oe,a.username)),s(r,z),G()}var Je=k('<div class="page-toolbar theme-toolbar svelte-1xv751g"><!> <!> <!></div>');function Ke(r,l){E(l,!0);let t=ee(l,"openTreePanel",3,()=>{}),a=ee(l,"openSettingsPanel",3,()=>{});const o=H(),i=te();let n=y(()=>i[o.currentPageID]!==void 0?i[o.currentPageID].title:"Loading...");var v=Je(),d=$(v);b(d,{iconURL:`${U??""}/images/icons/font-awesome/home.svg`,href:`${U??""}/`});var m=_(d,2);b(m,{iconURL:`${U??""}/images/icons/font-awesome/folder-closed.svg`,get onclick(){return a()}});var c=_(m,2);b(c,{get onclick(){return t()},children:(f,w)=>{I();var u=S();x(()=>R(u,e(n))),s(f,u)},$$slots:{default:!0}}),g(v),s(r,v),G()}var Qe=k("<!> <!> <!>",1),Ve=k('<div class="zoom-toolbar theme-toolbar svelte-16pmxx3"><!></div>');function We(r,l){E(l,!0);const t=H(),a=[.25,.5,.75,1,1.25,1.5,1.75,2];function o(){const c=a.find(f=>f>t.zoom);t.zoom=c!==void 0?c:a[a.length-1]}function i(){const c=a.toReversed().find(f=>f<t.zoom);t.zoom=c!==void 0?c:a[0]}function n(){const c=a.find(f=>f>t.zoom);t.zoom=c!==void 0?c:a[0]}function v(){t.zoom=1}var d=Ve(),m=$(d);Z(m,()=>l.variant==="alt",c=>{var f=Qe(),w=q(f);b(w,{iconURL:`${U??""}/images/icons/font-awesome/zoom-out.svg`,onclick:i});var u=_(w,2);b(u,{onclick:v,children:(z,N)=>{I();var L=S();x(()=>R(L,`${Math.round(t.zoom*100)??""}%`)),s(z,L)},$$slots:{default:!0}});var P=_(u,2);b(P,{iconURL:`${U??""}/images/icons/font-awesome/zoom-in.svg`,onclick:o}),s(c,f)},c=>{b(c,{onclick:n,children:(f,w)=>{I();var u=S();x(()=>R(u,`${Math.round(t.zoom*100)??""}%`)),s(f,u)},$$slots:{default:!0}})}),g(d),s(r,d),G()}var Ye=k("<option> </option>"),et=k("<select></select>");function tt(r,l){let t=ee(l,"name",3,"Select one"),a=ee(l,"value",15);var o=et();W(o,21,()=>l.options,Y,(i,n)=>{var v=Ye(),d={},m=$(v);g(v),x(()=>{d!==(d=e(n))&&(v.value=(v.__value=e(n))==null?"":e(n)),R(m,e(n))}),s(i,v)}),g(o),x(()=>{F(o,"name",t()),F(o,"id",l.id)}),Fe(o,a,i=>a(i)),s(r,o)}var ot=k("<!> <!> <!>",1),rt=k('<div class="settings-panel theme-panel svelte-1rflt3x"><!></div>');function at(r,l){E(l,!0);const t=H(),a=te();let o=y(()=>a[t.currentPageID]);var i=rt(),n=$(i);Z(n,()=>e(o),v=>{var d=ot(),m=q(d);Ie(m,{get value(){return e(o).title},set value(u){e(o).title=u}});var c=_(m,2);De(c,{get checked(){return t.spellcheck},set checked(u){t.spellcheck=u},id:"spellcheck",children:(u,P)=>{I();var z=S("Spellcheck");s(u,z)},$$slots:{default:!0}});var f=_(c,2),w=y(Ne);tt(f,{id:"theme-select",name:"Theme",get options(){return e(w)},get value(){return t.themeName},set value(u){t.themeName=u}}),s(v,d)},v=>{var d=S("Loading...");s(v,d)}),g(i),s(r,i),G()}var nt=k('<div class="page-container svelte-1cqpher"><header></header> <main><!> <!> <!> <!></main> <footer class="svelte-1cqpher"><p>Orphans:</p> <!> <!></footer></div>');function bt(r,l){E(l,!0),H();const t=te();Ce();const a=xe();var o=nt(),i=_($(o),2),n=$(i);Ke(n,{});var v=_(n,2);We(v,{variant:"alt"});var d=_(v,2);He(d,{});var m=_(d,2);at(m,{}),g(i);var c=_(i,2),f=_($(c),2);W(f,17,()=>a.orphanedFolders,Y,(u,P)=>{var z=V(),N=q(z);Z(N,()=>a.tree[e(P)].type==="folder",L=>{b(L,{variant:"error",onclick:()=>{delete a.tree[e(P)]},children:(oe,re)=>{I();var O=S();x(()=>R(O,`💀📁${a.tree[e(P)].name??""}`)),s(oe,O)},$$slots:{default:!0}})}),s(u,z)});var w=_(f,2);W(w,17,()=>a.orphanedPages,Y,(u,P)=>{b(u,{variant:"error",onclick:()=>{delete a.tree[e(P)],delete t[e(P)]},children:(z,N)=>{I();var L=S();x(()=>R(L,`💀📄${t[e(P)].title??""}`)),s(z,L)},$$slots:{default:!0}})}),g(c),g(o),s(r,o),G()}export{bt as component};
