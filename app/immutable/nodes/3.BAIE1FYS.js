var ae=a=>{throw TypeError(a)};var _e=(a,e,t)=>e.has(a)||ae("Cannot "+t);var Y=(a,e,t)=>(_e(a,e,"read from private field"),t?t.call(a):e.get(a)),Z=(a,e,t)=>e.has(a)?ae("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t);import{a as R,t as L,c as he}from"../chunks/disclose-version.CpwCgqSZ.js";import{b as be,h as M,k as ge,w as me,M as ce,l as ye,r as ne,i as oe,s as $,c as q,m as ue,a as de,p as De,aa as ke,B as se,q as W,ab as xe,ac as we,a2 as ze,n as B,ad as Ee,ae as Ie,L as Pe,af as Fe,d as Ne,I as Te,g as Ae,o as D,ag as re,R as Ce,V as Se,O as Re,_ as j,a3 as le,P as Oe,a4 as F,a6 as f,a5 as N}from"../chunks/runtime.zjbhdcTH.js";import{s as ee}from"../chunks/render.x2q_J-LW.js";import{i as Me}from"../chunks/if.fxwIRUMZ.js";import{r as K}from"../chunks/attributes.Dwwz4tQW.js";import{d as Ue}from"../chunks/events.CyuGU5Uw.js";import{b as X}from"../chunks/input.DM-jeKjV.js";import{p as U}from"../chunks/pagesState.svelte.hY4uYK8S.js";import{a as He}from"../chunks/authUtils.z_lGj5-3.js";import{g as ve,b as pe}from"../chunks/entry.DhtXf55u.js";import{u as Le}from"../chunks/userState.svelte.DV4QwUgh.js";import{p as H}from"../chunks/proxy.DWE3J2IR.js";import{g as Ye}from"../chunks/app.svelte.Bs1Ymz2A.js";let te=null;function J(a,e){return e}function qe(a,e,t,r){for(var d=[],u=e.length,o=0;o<u;o++)Ie(e[o].e,d,!0);var s=u>0&&d.length===0&&t!==null;if(s){var _=t.parentNode;Pe(_),_.append(t),r.clear(),C(a,e[0].prev,e[u-1].next)}Fe(d,()=>{for(var n=0;n<u;n++){var v=e[n];s||(r.delete(v.k),C(a,v.prev,v.next)),Ne(v.e,!s)}})}function Q(a,e,t,r,d,u=null){var o=a,s={flags:e,items:new Map,first:null};M&&ge();var _=null;be(()=>{var n=t(),v=me(n)?n:n==null?[]:ce(n),l=v.length;let p=!1;if(M){var g=o.data===ye;g!==(l===0)&&(o=ne(),oe(o),$(!1),p=!0)}if(M){for(var c=null,P,i=0;i<l;i++){if(q.nodeType===8&&q.data===Te){o=q,p=!0,$(!1);break}var k=v[i],S=r(k,i);P=fe(q,s,c,null,k,S,i,d,e),s.items.set(S,P),c=P}l>0&&oe(ne())}M||Be(v,s,o,d,e,r),u!==null&&(l===0?_?ue(_):_=de(()=>u(o)):_!==null&&De(_,()=>{_=null})),p&&$(!0)}),M&&(o=q)}function Be(a,e,t,r,d,u){var o=a.length,s=e.items,_=e.first,n=_,v,l=null,p=[],g=[],c,P,i,k;for(k=0;k<o;k+=1){if(c=a[k],P=u(c,k),i=s.get(P),i===void 0){var S=n?n.e.nodes_start:t;l=fe(S,e,l,l===null?e.first:l.next,c,P,k,r,d),s.set(P,l),p=[],g=[],n=l.next;continue}if(Ge(i,c,k),i.e.f&ke&&ue(i.e),i!==n){if(v!==void 0&&v.has(i)){if(p.length<g.length){var O=g[0],T;l=O.prev;var m=p[0],h=p[p.length-1];for(T=0;T<p.length;T+=1)ie(p[T],O,t);for(T=0;T<g.length;T+=1)v.delete(g[T]);C(e,m.prev,h.next),C(e,l,m),C(e,h,O),n=O,l=h,k-=1,p=[],g=[]}else v.delete(i),ie(i,n,t),C(e,i.prev,i.next),C(e,i,l===null?e.first:l.next),C(e,l,i),l=i;continue}for(p=[],g=[];n!==null&&n.k!==P;)(v??(v=new Set)).add(n),g.push(n),n=n.next;if(n===null)continue;i=n}p.push(i),l=i,n=i.next}if(n!==null||v!==void 0){for(var y=v===void 0?[]:ce(v);n!==null;)y.push(n),n=n.next;var E=y.length;if(E>0){var x=null;qe(e,y,x,s)}}se.first=e.first&&e.first.e,se.last=l&&l.e}function Ge(a,e,t,r){W(a.v,e),a.i=t}function fe(a,e,t,r,d,u,o,s,_){var n=te;try{var v=(_&xe)!==0,l=(_&we)===0,p=v?l?ze(d):B(d):d,g=_&Ee?B(o):o,c={i:g,v:p,k:u,a:null,e:null,prev:t,next:r};return te=c,c.e=de(()=>s(a,p,g),M),c.e.prev=t&&t.e,c.e.next=r&&r.e,t===null?e.first=c:(t.next=c,t.e.next=c.e),r!==null&&(r.prev=c,r.e.prev=c.e),c}finally{te=n}}function ie(a,e,t){for(var r=a.next?a.next.e.nodes_start:t,d=e?e.e.nodes_start:t,u=a.e.nodes_start;u!==r;){var o=Ae(u);d.before(u),u=o}}function C(a,e,t){e===null?a.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Ve(){let a=re(()=>Le.get().root),e=B(H([]));const t=function(o){let s=D(a);for(const _ in o)s=s.subDirectories[o[_]];return s};let r=re(()=>t(D(e)));const d=function(o){let s=t(D(e));delete s.subDirectories[o]},u=function(o="New Folder"){let s=t(D(e));s.subDirectories[crypto.randomUUID().slice(0,8)]={name:o,subDirectories:{},pageIDs:[]}};return{get root(){return D(a)},get currentPath(){return D(e)},set currentPath(o){W(e,H(o))},get currentDirectory(){return D(r)},get getDirectory(){return t},get addDirectory(){return u},get deleteDirectory(){return d}}}const b=Ve();var G,V;class Ke{constructor(){Z(this,G,B(H({})));Z(this,V,B(H([])));Se(()=>{})}get root(){return D(Y(this,G))}set root(e){W(Y(this,G),H(e))}get path(){return D(Y(this,V))}set path(e){W(Y(this,V),H(e))}uniqueFolderName(e,t){if(!e.folders||e.folders[t]===void 0)return t;let r=1;for(;e.folders[t+r]!==void 0;)r+=1;return`${t} (${r})`}getFolder(e){let t=this.root;for(let r=0;r<e.length;(r+=1)-1){if(!t.folders||t.folders[e[r]]===void 0)throw new Error("Cannot get folder, path is not valid!");t=t.folders[e[r]]}return t}newFolder(e="New Folder",t){let r=this.getFolder(t||this.path);r.folders||(r.folders={}),r.folders[this.uniqueFolderName(r,e)]={}}deleteFolder(e,t){let r=this.getFolder(t||this.path);if(!r.folders||r.folders[e]===void 0){console.warn("No folder to delete");return}delete r.folders[e]}newFile(e,t){let r=this.getFolder(t||this.path);r.ids||(r.ids=[]),r.ids.push(e)}deleteFile(e,t){let r=this.getFolder(t||this.path);!r.ids||r.ids.includes(e)===!1||(r.ids=r.ids.filter(d=>d!==e))}}G=new WeakMap,V=new WeakMap;const Xe=Symbol("folderStore"),Je=()=>{const a=new Ke;return Ce(Xe,a)};var Qe=()=>{He()},We=L('<p>/ <input type="text"></p>'),Ze=L('<p>/</p> <button class="svelte-2z9p5h"> </button>',1),$e=L('<div class="path svelte-2z9p5h"><p>ğŸ“‚</p> <input type="text"> <button class="open-subpath-button svelte-2z9p5h">Go</button> <button class="delete-subpath-button svelte-2z9p5h">âŒ</button></div>'),je=(a,e)=>ve(pe+"/"+e()+"/"),et=(a,e)=>delete U.get()[e()],tt=L('<div class="page svelte-2z9p5h"><p>ğŸ“„</p> <input type="text"> <button class="goto-page-button svelte-2z9p5h">Go</button> <button class="close-page-button svelte-2z9p5h">âŒ</button></div>'),rt=(a,e)=>ve(pe+"/"+e()+"/"),at=(a,e)=>delete U.get()[e()],nt=L('<div class="page svelte-2z9p5h"><p>ğŸ“„</p> <input type="text"> <button class="goto-page-button svelte-2z9p5h">Go</button> <button class="close-page-button svelte-2z9p5h">âŒ</button></div>'),ot=L('<header class="svelte-2z9p5h"><button class="logout-button svelte-2z9p5h">Logout</button> <button class="spellcheck-button svelte-2z9p5h"> </button> <button class="new-page-button svelte-2z9p5h">+ğŸ“„</button> <button class="new-path-button svelte-2z9p5h">+ğŸ“‚</button></header> <main><div class="current-path svelte-2z9p5h"><button class="back-button svelte-2z9p5h">Back</button> <button class="home-button svelte-2z9p5h"> </button> <!></div> <section id="items" class="svelte-2z9p5h"><!> <!></section> <br> <br> <p>All pages:</p> <!></main>',1);function yt(a,e){Re(e,!0),Je();const t=Ye();let r=re(()=>{let m={};return b.currentDirectory.pageIDs.forEach(h=>{h in U.get()&&(m[h]=U.get()[h])}),m});var d=ot(),u=j(d),o=F(u);o.__click=[Qe];var s=f(o,2);s.__click=()=>{t.spellcheck=!t.spellcheck};var _=F(s);N(s);var n=f(s,2);n.__click=()=>{const m=crypto.randomUUID().slice(0,8),h={title:"New Page",content:"",lastUpdated:Date.now()};U.get()[m]=h,b.currentDirectory.pageIDs.push(m)};var v=f(n,2);v.__click=()=>{b.addDirectory("New")},N(u);var l=f(u,2),p=F(l),g=F(p);g.__click=()=>{b.currentPath.pop()};var c=f(g,2);c.__click=()=>{b.currentPath=[]};var P=F(c);N(c);var i=f(c,2);Q(i,17,()=>b.currentPath,J,(m,h,y)=>{var E=he(),x=j(E);Me(x,()=>y===b.currentPath.length-1,w=>{var z=We(),I=f(F(z));K(I),N(z),X(I,()=>b.currentDirectory.name,A=>b.currentDirectory.name=A),R(w,z)},w=>{var z=Ze(),I=f(j(z),2);I.__click=()=>{b.currentPath=b.currentPath.slice(0,y+1)};var A=F(I);le(()=>ee(A,b.getDirectory(b.currentPath.slice(0,y+1)).name)),N(I),R(w,z)}),R(m,E)}),N(p);var k=f(p,2),S=F(k);Q(S,17,()=>Object.entries(b.currentDirectory.subDirectories),J,(m,h)=>{let y=()=>D(h)[0],E=()=>D(h)[1];var x=$e(),w=f(F(x),2);K(w);var z=f(w,2);z.__click=()=>{b.currentPath.push(y())};var I=f(z,2);I.__click=()=>{b.deleteDirectory(y())},N(x),X(w,()=>E().name,A=>E().name=A),R(m,x)});var O=f(S,2);Q(O,17,()=>Object.entries(D(r)),J,(m,h)=>{let y=()=>D(h)[0],E=()=>D(h)[1];var x=tt(),w=f(F(x),2);K(w);var z=f(w,2);z.__click=[je,y];var I=f(z,2);I.__click=[et,y],N(x),X(w,()=>E().title,A=>E().title=A),R(m,x)}),N(k);var T=f(k,8);Q(T,17,()=>Object.entries(U.get()),J,(m,h)=>{let y=()=>D(h)[0],E=()=>D(h)[1];var x=nt(),w=f(F(x),2);K(w);var z=f(w,2);z.__click=[rt,y];var I=f(z,2);I.__click=[at,y],N(x),X(w,()=>E().title,A=>E().title=A),R(m,x)}),N(l),le(()=>{ee(_,`Spellcheck: ${t.spellcheck??""}`),g.disabled=b.currentPath.length===0,ee(P,b.root.name)}),R(a,d),Oe()}Ue(["click"]);export{yt as component};
