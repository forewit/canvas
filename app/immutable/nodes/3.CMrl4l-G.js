import{a as u,t as f,c as q}from"../chunks/disclose-version.BRFWJlgu.js";import{K as J,m as se,u as ne,l as ie,O as a,R as o,P as l,ap as C,k as c,M as N,ag as z,n as S,Q as E}from"../chunks/runtime.De9YyAkO.js";import{s as I}from"../chunks/render.DNGc7hJe.js";import{p as G,i as le}from"../chunks/if.DxqyGXBG.js";import{e as F,i as $,F as de}from"../chunks/Folder.CNKdguSv.js";import{s as ce}from"../chunks/attributes.N1z6uQRr.js";import{d as V}from"../chunks/events.-h2mbIF3.js";import{g as ve}from"../chunks/entry.t6y0RqSM.js";import{b as h}from"../chunks/paths.CRSbkVVD.js";import{g as ue}from"../chunks/app.svelte.omhvH3X-.js";import{g as ge}from"../chunks/pages.svelte.BplmUK_0.js";import{g as pe}from"../chunks/firebase.svelte.DK2MtVdp.js";import{g as W}from"../chunks/directories.svelte.Cil8smhP.js";import{B as M}from"../chunks/TextInput.BryWsCEc.js";import{I as R}from"../chunks/Icon.DylpRlJe.js";function H(v,n=navigator.language){const i=typeof v=="number"?v:v.getTime(),e=Math.round((i-Date.now())/1e3),g=[60,3600,86400,86400*7,86400*30,86400*365,1/0],m=["second","minute","hour","day","week","month","year"],p=g.findIndex(k=>k>Math.abs(e)),_=p?g[p-1]:1;return new Intl.RelativeTimeFormat(n,{numeric:"auto"}).format(Math.floor(e/_),m[p])}var _e=f('<button class="page svelte-4d10e3"><p class="title"> </p> <p class="last-updated svelte-4d10e3"> </p></button>');function fe(v,n){J(n,!0);const i=W();let e=se(G(H(n.page.lastUpdated)));ne(()=>{i.currentFolder.pages&&i.currentFolder.pages.length>0&&ie(e,G(H(n.page.lastUpdated)))});var g=_e();g.__click=function(...k){var y;(y=n.onclick)==null||y.apply(this,k)};var m=a(g),p=a(m);o(m);var _=l(m,2),x=a(_);o(_),o(g),C(()=>{I(p,n.page.title),I(x,c(e))}),u(v,g),N()}V(["click"]);var me=f('<div class="item svelte-9uygd5"><!></div>'),be=(v,n)=>n.addSubfolder(),he=f('<!> <div class="item svelte-9uygd5"><button class="add-folder svelte-9uygd5"><!></button></div>',1),ye=(v,n)=>n.addSubfolder(),ke=f('<div class="full-width-item svelte-9uygd5"><button class="add-folder svelte-9uygd5"><!></button></div>'),xe=f('<div class="full-width-item svelte-9uygd5"><!></div>'),Pe=(v,n,i)=>{const e=n();i.addPageID(e)},Fe=(v,n,i)=>{delete n.folders[c(i)]},$e=f('<p> <button class="close-page-button">❌</button></p>'),Ie=f('<p> <button class="close-page-button">❌</button></p>'),Ue=f('<header class="svelte-9uygd5"><!></header> <main class="svelte-9uygd5"><div class="grid svelte-9uygd5"><!> <!> <div class="full-width-item svelte-9uygd5"><button class="add-page svelte-9uygd5"><!></button></div></div></main> <footer class="svelte-9uygd5"><a><!></a> <!> <section id="orphaned-folders"><p>Orphaned folders:</p> <!></section> <section id="orphaned-pages"><p>Orphaned pages:</p> <!></section></footer>',1);function ze(v,n){J(n,!0),ue();const i=ge();pe();const e=W();let g=S(()=>Object.keys(i).filter(r=>e.currentFolder.pages&&e.currentFolder.pages.includes(r)));function m(){const r=crypto.randomUUID().slice(0,8),s={title:"Untitled",content:"",lastUpdated:Date.now()};return i[r]=s,r}var p=Ue(),_=z(p),x=a(_),k=S(()=>e.currentPath.length<=1);M(x,{variant:"alt",onclick:()=>{e.currentPath.length>1&&e.currentPath.pop()},get disabled(){return c(k)},children:(r,s)=>{E();var t=q("🔙");u(r,t)},$$slots:{default:!0}}),o(_);var y=l(_,2),O=a(y),T=a(O);le(T,()=>e.currentFolder.subfolders,r=>{var s=he(),t=z(s);F(t,17,()=>e.currentFolder.subfolders,$,(ae,Q)=>{var D=me(),oe=a(D);de(oe,{get folder(){return e.folders[c(Q)]},onclick:()=>e.currentPath.push(c(Q))}),o(D),u(ae,D)});var d=l(t,2),b=a(d);b.__click=[be,e];var re=a(b);R(re,{url:`${h??""}/images/icons/plus.svg`,color:"var(--bg)"}),o(b),o(d),u(r,s)},r=>{var s=ke(),t=a(s);t.__click=[ye,e];var d=a(t);R(d,{url:`${h??""}/images/icons/plus.svg`,color:"var(--bg)"}),o(t),o(s),u(r,s)});var B=l(T,2);F(B,17,()=>c(g),$,(r,s)=>{var t=xe(),d=a(t);fe(d,{get page(){return i[c(s)]},onclick:()=>ve(h+"/"+c(s)+"/")}),o(t),u(r,t)});var L=l(B,2),U=a(L);U.__click=[Pe,m,e];var X=a(U);R(X,{url:`${h??""}/images/icons/plus.svg`,color:"var(--bg)"}),o(U),o(L),o(O),o(y);var j=l(y,2),P=a(j);ce(P,"href",`${h??""}/profile`);var Y=a(P);M(Y,{iconURL:`${h??""}/images/icons/gear.svg`}),o(P);var A=l(P,2),Z=S(()=>e.currentPath.length<=1);M(A,{variant:"error",iconURL:`${h??""}/images/icons/xmark-small.svg`,get disabled(){return c(Z)},onclick:()=>{if(e.currentPath.length>1){const r=e.currentPath.pop();r&&e.removeSubfolder(r)}},children:(r,s)=>{E();var t=q("Delete Folder");u(r,t)},$$slots:{default:!0}});var w=l(A,2),ee=l(a(w),2);F(ee,17,()=>e.orphanedFolders,$,(r,s)=>{var t=$e(),d=a(t),b=l(d);b.__click=[Fe,e,s],o(t),C(()=>I(d,`💀📁 ${e.folders[c(s)].name??""}`)),u(r,t)}),o(w);var K=l(w,2),te=l(a(K),2);F(te,17,()=>e.orphanedPages,$,(r,s)=>{var t=Ie(),d=a(t),b=l(d);b.__click=()=>{delete i[c(s)]},o(t),C(()=>I(d,`💀📄 ${i[c(s)].title??""}`)),u(r,t)}),o(K),o(j),u(v,p),N()}V(["click"]);export{ze as component};
