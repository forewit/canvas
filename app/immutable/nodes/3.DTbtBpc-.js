import{a as l,t as $,d as ce,b as D}from"../chunks/disclose-version.BlsN6X0a.js";import{f as be,w as H,a as de,y as x,z as J,x as F,ai as Re,b as e,d as w,B as g,C as f,A as u,X as C,c as ue,a3 as Se,aw as Ie}from"../chunks/runtime.BZ2yvmcy.js";import{s as R}from"../chunks/render.ClryS_dF.js";import{B as P,e as Y,i as ee,a as De,T as Te}from"../chunks/Toggle.DCBEOQqn.js";import{d as Ne}from"../chunks/events.BXoHu6kc.js";import{b as z}from"../chunks/paths.DjZ7Slcj.js";import{g as K,b as qe}from"../chunks/app.svelte.BFvhVt60.js";import{g as oe}from"../chunks/pages.svelte.DoMi3FPE.js";import{g as Ce}from"../chunks/firebase.svelte.-uLT7CDo.js";import{g as $e}from"../chunks/directories.svelte.ODE6lz04.js";import{i as B}from"../chunks/if.B69R1Din.js";import{s as M}from"../chunks/attributes.Dac1tSuF.js";import{i as Ze,p as W}from"../chunks/proxy.Csehax7D.js";import{p as te}from"../chunks/index-client.GEksk9V3.js";import{l as Oe}from"../chunks/input.DstR4QUx.js";function xe(o,n,t){if(o.multiple)return Be(o,n);for(var a of o.options){var r=G(a);if(Ze(r,n)){a.selected=!0;return}}(!t||n!==void 0)&&(o.selectedIndex=-1)}function Ae(o,n){be(()=>{var t=new MutationObserver(()=>{var a=o.__value;xe(o,a)});return t.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function Fe(o,n,t){var a=!0;Oe(o,"change",()=>{var r;if(o.multiple)r=[].map.call(o.querySelectorAll(":checked"),G);else{var i=o.querySelector(":checked");r=i&&G(i)}t(r)}),be(()=>{var r=n();if(xe(o,r,a),a&&r===void 0){var i=o.querySelector(":checked");i!==null&&(r=G(i),t(r))}o.__value=r,a=!1}),Ae(o)}function Be(o,n){for(var t of o.options)t.selected=~n.indexOf(G(t))}function G(o){return"__value"in o?o.__value:o.value}var Me=$('<li><div class="button svelte-rpge36"><!></div></li>'),Xe=$('<div class="button svelte-rpge36"><!></div> <!>',1),je=$('<div class="button svelte-rpge36"><!></div>'),Ee=$("<li><!></li>"),Ge=$('<ol class="svelte-rpge36"></ol>'),He=$('<div class="tree-panel theme-panel svelte-rpge36"><div class="controls svelte-rpge36"><p class="title svelte-rpge36"> </p> <!> <!> <!></div> <div class="directory svelte-rpge36"><!></div></div>');function Je(o,n){H(n,!0);const t=(b,Z=Re,re)=>{let pe=Se(()=>Ie(re==null?void 0:re(),0));var me=ce(),we=F(me);B(we,()=>Z().type==="folder",ze=>{var Q=Ge();Y(Q,21,()=>Z().children,ee,(Le,h)=>{var ge=ce(),Ue=F(ge);B(Ue,()=>e(s)[e(h)].type==="page",ae=>{var A=Me(),X=g(A),ne=g(X),j=w(()=>e(_)===e(h)),se=w(()=>e(_)===e(h)?0:void 0);P(ne,{get selected(){return e(j)},get tabindex(){return e(se)},iconURL:`${z??""}/images/icons/font-awesome/feather.svg`,onclick:()=>k(e(h)),children:(E,q)=>{C();var I=D();x(()=>R(I,i[e(s)[e(h)].pageID].title)),l(E,I)},$$slots:{default:!0}}),f(X),f(A),x(()=>M(X,"id",e(h))),l(ae,A)},ae=>{var A=ce(),X=F(A);B(X,()=>e(s)[e(h)].type==="folder",ne=>{var j=Ee(),se=g(j);B(se,()=>e(v).includes(e(h)),E=>{var q=Xe(),I=F(q),le=g(I),ie=w(()=>e(_)===e(h)),ve=w(()=>e(_)===e(h)?0:void 0);P(le,{get selected(){return e(ie)},get tabindex(){return e(ve)},iconURL:`${z??""}/images/icons/font-awesome/folder-open.svg`,onclick:()=>k(e(h)),children:(V,dt)=>{C();var he=D();x(()=>R(he,e(s)[e(h)].name)),l(V,he)},$$slots:{default:!0}}),f(I);var _e=u(I,2);t(_e,()=>e(s)[e(h)],()=>e(pe)+1),x(()=>M(I,"id",e(h))),l(E,q)},E=>{var q=je(),I=g(q),le=w(()=>e(_)===e(h)),ie=w(()=>e(_)===e(h)?0:void 0);P(I,{get selected(){return e(le)},get tabindex(){return e(ie)},iconURL:`${z??""}/images/icons/font-awesome/folder-closed.svg`,onclick:()=>k(e(h)),children:(ve,_e)=>{C();var V=D();x(()=>R(V,e(s)[e(h)].name)),l(ve,V)},$$slots:{default:!0}}),f(q),x(()=>M(q,"id",e(h))),l(E,q)}),f(j),l(ne,j)},null,!0),l(ae,A)}),l(Le,ge)}),f(Q),x(()=>M(Q,"style",`--depth: ${e(pe)??""}`)),l(ze,Q)}),l(b,me)},a=K(),r=$e(),i=oe();let s=w(()=>r.tree),v=de(W(["root"])),c=de("root"),_=de("root"),d=w(()=>{for(const b in e(s))if(e(s)[b].type==="folder"&&e(s)[b].children.includes(e(c)))return b;return"root"}),p=w(()=>e(s)[e(c)].type==="folder"?e(c):e(d));function k(b){e(s)[b].type==="folder"?e(v).includes(b)?ue(v,W(e(v).filter(Z=>Z!==b))):e(v).push(b):e(s)[b].type==="page"&&(a.currentPageID=e(s)[b].pageID),ue(c,W(b)),ue(_,W(b))}function m(){confirm("Are you sure you want to delete?")&&r.removeChild(e(d),e(c))}function T(b){if(e(v).push(e(p)),b==="folder")r.addSubfolder(e(p));else if(b==="page"){const Z=crypto.randomUUID().slice(0,8);i[Z]={lastUpdated:Date.now(),title:"Untitled",content:""},r.addPageID(e(p),Z)}}var S=He(),U=g(S),y=g(U),L=g(y);f(y);var N=u(y,2);P(N,{iconURL:`${z??""}/images/icons/font-awesome/folder-new.svg`,onclick:()=>T("folder")});var O=u(N,2);P(O,{iconURL:`${z??""}/images/icons/font-awesome/feather.svg`,onclick:()=>T("page")});var ke=u(O,2),Pe=w(()=>!e(c)||e(c)==="root");P(ke,{get disabled(){return e(Pe)},iconURL:`${z??""}/images/icons/font-awesome/trash.svg`,onclick:m}),f(U);var fe=u(U,2),ye=g(fe);t(ye,()=>e(s).root),f(fe),f(S),x(()=>R(L,a.username)),l(o,S),J()}var Ke=$('<div class="page-toolbar theme-toolbar svelte-1xv751g"><!> <!> <!></div>');function Qe(o,n){H(n,!0);let t=te(n,"openTreePanel",3,()=>{}),a=te(n,"openSettingsPanel",3,()=>{});const r=K(),i=oe();let s=w(()=>i[r.currentPageID]!==void 0?i[r.currentPageID].title:"Loading...");var v=Ke(),c=g(v);P(c,{iconURL:`${z??""}/images/icons/font-awesome/home.svg`,href:`${z??""}/`});var _=u(c,2);P(_,{iconURL:`${z??""}/images/icons/font-awesome/folder-closed.svg`,get onclick(){return a()}});var d=u(_,2);P(d,{get onclick(){return t()},children:(p,k)=>{C();var m=D();x(()=>R(m,e(s))),l(p,m)},$$slots:{default:!0}}),f(v),l(o,v),J()}var Ve=$("<!> <!> <!>",1),We=$('<div class="zoom-toolbar theme-toolbar svelte-16pmxx3"><!></div>');function Ye(o,n){H(n,!0);const t=K(),a=[.25,.5,.75,1,1.25,1.5,1.75,2];function r(){const d=a.find(p=>p>t.zoom);t.zoom=d!==void 0?d:a[a.length-1]}function i(){const d=a.toReversed().find(p=>p<t.zoom);t.zoom=d!==void 0?d:a[0]}function s(){const d=a.find(p=>p>t.zoom);t.zoom=d!==void 0?d:a[0]}function v(){t.zoom=1}var c=We(),_=g(c);B(_,()=>n.variant==="alt",d=>{var p=Ve(),k=F(p);P(k,{iconURL:`${z??""}/images/icons/font-awesome/zoom-out.svg`,onclick:i});var m=u(k,2);P(m,{onclick:v,children:(S,U)=>{C();var y=D();x(()=>R(y,`${Math.round(t.zoom*100)??""}%`)),l(S,y)},$$slots:{default:!0}});var T=u(m,2);P(T,{iconURL:`${z??""}/images/icons/font-awesome/zoom-in.svg`,onclick:r}),l(d,p)},d=>{P(d,{onclick:s,children:(p,k)=>{C();var m=D();x(()=>R(m,`${Math.round(t.zoom*100)??""}%`)),l(p,m)},$$slots:{default:!0}})}),f(c),l(o,c),J()}var et=$("<option> </option>"),tt=$("<select></select>");function ot(o,n){let t=te(n,"name",3,"Select one"),a=te(n,"value",15);var r=tt();Y(r,21,()=>n.options,ee,(i,s)=>{var v=et(),c={},_=g(v);f(v),x(()=>{c!==(c=e(s))&&(v.value=(v.__value=e(s))==null?"":e(s)),R(_,e(s))}),l(i,v)}),f(r),x(()=>{M(r,"name",t()),M(r,"id",n.id)}),Fe(r,a,i=>a(i)),l(o,r)}var rt=$("<!> <!> <!>",1),at=$('<div class="settings-panel theme-panel svelte-1rflt3x"><!></div>');function nt(o,n){H(n,!0);const t=K(),a=oe();let r=w(()=>a[t.currentPageID]);var i=at(),s=g(i);B(s,()=>e(r),v=>{var c=rt(),_=F(c);De(_,{get value(){return e(r).title},set value(m){e(r).title=m}});var d=u(_,2);Te(d,{get checked(){return t.spellcheck},set checked(m){t.spellcheck=m},id:"spellcheck",children:(m,T)=>{C();var S=D("Spellcheck");l(m,S)},$$slots:{default:!0}});var p=u(d,2),k=w(qe);ot(p,{id:"theme-select",name:"Theme",get options(){return e(k)},get value(){return t.themeName},set value(m){t.themeName=m}}),l(v,c)},v=>{var c=D("Loading...");l(v,c)}),f(i),l(o,i),J()}var st=(o,n,t)=>{delete n.tree[e(t)]},lt=$('<p> <button class="close-page-button">❌</button></p>'),it=(o,n,t)=>{delete n[e(t)]},vt=$('<p> <button class="close-page-button">❌</button></p>'),ct=$('<div class="page-container svelte-1khv4q7"><header></header> <main class="svelte-1khv4q7"><!> <!> <!> <!></main> <footer class="svelte-1khv4q7"><!> <section id="orphaned-folders"><p>Orphaned folders:</p> <!></section> <section id="orphaned-pages"><p>Orphaned pages:</p> <!></section></footer></div>');function Lt(o,n){H(n,!0),K();const t=oe();Ce();const a=$e();var r=ct(),i=u(g(r),2),s=g(i);Qe(s,{});var v=u(s,2);Ye(v,{variant:"alt"});var c=u(v,2);Je(c,{});var _=u(c,2);nt(_,{}),f(i);var d=u(i,2),p=g(d);P(p,{iconURL:`${z??""}/images/icons/gear.svg`,href:`${z??""}/profile`,children:(U,y)=>{C();var L=D("Settings");l(U,L)},$$slots:{default:!0}});var k=u(p,2),m=u(g(k),2);Y(m,17,()=>a.orphanedFolders,ee,(U,y)=>{var L=lt(),N=g(L),O=u(N);O.__click=[st,a,y],f(L),x(()=>R(N,`💀📁 ${a.tree[e(y)].name??""}`)),l(U,L)}),f(k);var T=u(k,2),S=u(g(T),2);Y(S,17,()=>a.orphanedPages,ee,(U,y)=>{var L=vt(),N=g(L),O=u(N);O.__click=[it,t,y],f(L),x(()=>R(N,`💀📄 ${t[e(y)].title??""}`)),l(U,L)}),f(T),f(d),f(r),l(o,r),J()}Ne(["click"]);export{Lt as component};
