var le=a=>{throw TypeError(a)};var me=(a,e,t)=>e.has(a)||le("Cannot "+t);var M=(a,e,t)=>(me(a,e,"read from private field"),t?t.call(a):e.get(a)),V=(a,e,t)=>e.has(a)?le("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t);import{a as R,t as G,c as De}from"../chunks/disclose-version.C3Ap_Fdw.js";import{e as ke,b as ye,aa as ve,h as S,i as B,k as xe,A as we,Q as pe,l as Ee,r as ie,s as K,c as O,m as he,a as _e,p as Ie,ab as ze,y as Ae,G as ue,ac as ee,w as U,ad as te,ae as Pe,a2 as Ce,t as L,af as Ne,P as Te,ag as Fe,d as Se,j as Re,M as He,ah as Me,g as Oe,v as A,ai as ce,$ as Ue,u as Le,T as Ye,_ as Q,a3 as de,V as qe,a4 as T,a6 as k,a5 as N}from"../chunks/runtime.CrOvq7Gc.js";import{s as X}from"../chunks/render.DcDgj3Hd.js";import{i as Ge}from"../chunks/if.C0GAPCmN.js";import{r as J}from"../chunks/attributes.CKa9Kjde.js";import{d as Ve}from"../chunks/events.B6Flj5Su.js";import{b as W}from"../chunks/input.ChQbtpl-.js";import"../chunks/pagesState.svelte.Dqb3nbwb.js";import{a as Be}from"../chunks/authUtils.DLvMaj9w.js";import{g as Ke,b as Qe}from"../chunks/entry.Bpl0Gw6I.js";import{u as Xe}from"../chunks/userState.svelte.lnJRSS7l.js";import{p as H}from"../chunks/proxy.V3ps-ERZ.js";import{g as Je,a as We}from"../chunks/pages.svelte.B2tb6MQV.js";let Z=null;function $(a,e){return e}function Ze(a,e,t,r){for(var u=[],f=e.length,o=0;o<f;o++)Ne(e[o].e,u,!0);var c=f>0&&u.length===0&&t!==null;if(c){var b=t.parentNode;Te(b),b.append(t),r.clear(),F(a,e[0].prev,e[f-1].next)}Fe(u,()=>{for(var g=0;g<f;g++){var h=e[g];c||(r.delete(h.k),F(a,h.prev,h.next)),Se(h.e,!c)}})}function j(a,e,t,r,u,f=null){var o=a,c={flags:e,items:new Map,first:null},b=(e&ve)!==0;if(b){var g=a;o=S?B(Re(g)):g.appendChild(ke())}S&&xe();var h=null;ye(()=>{var l=t(),v=we(l)?l:l==null?[]:pe(l),i=v.length;let d=!1;if(S){var x=o.data===Ee;x!==(i===0)&&(o=ie(),B(o),K(!1),d=!0)}if(S){for(var I=null,w,y=0;y<i;y++){if(O.nodeType===8&&O.data===He){o=O,d=!0,K(!1);break}var n=v[y],s=r(n,y);w=be(O,c,I,null,n,s,y,u,e),c.items.set(s,w),I=w}i>0&&B(ie())}S||$e(v,c,o,u,e,r),f!==null&&(i===0?h?he(h):h=_e(()=>f(o)):h!==null&&Ie(h,()=>{h=null})),d&&K(!0)}),S&&(o=O)}function $e(a,e,t,r,u,f){var re,ae,ne,oe;var o=(u&Me)!==0,c=(u&(ee|te))!==0,b=a.length,g=e.items,h=e.first,l=h,v,i=null,d,x=[],I=[],w,y,n,s;if(o)for(s=0;s<b;s+=1)w=a[s],y=f(w,s),n=g.get(y),n!==void 0&&((re=n.a)==null||re.measure(),(d??(d=new Set)).add(n));for(s=0;s<b;s+=1){if(w=a[s],y=f(w,s),n=g.get(y),n===void 0){var P=l?l.e.nodes_start:t;i=be(P,e,i,i===null?e.first:i.next,w,y,s,r,u),g.set(y,i),x=[],I=[],l=i.next;continue}if(c&&je(n,w,s,u),n.e.f&ze&&(he(n.e),o&&((ae=n.a)==null||ae.unfix(),(d??(d=new Set)).delete(n))),n!==l){if(v!==void 0&&v.has(n)){if(x.length<I.length){var z=I[0],p;i=z.prev;var E=x[0],m=x[x.length-1];for(p=0;p<x.length;p+=1)fe(x[p],z,t);for(p=0;p<I.length;p+=1)v.delete(I[p]);F(e,E.prev,m.next),F(e,i,E),F(e,m,z),l=z,i=m,s-=1,x=[],I=[]}else v.delete(n),fe(n,l,t),F(e,n.prev,n.next),F(e,n,i===null?e.first:i.next),F(e,i,n),i=n;continue}for(x=[],I=[];l!==null&&l.k!==y;)(v??(v=new Set)).add(l),I.push(l),l=l.next;if(l===null)continue;n=l}x.push(n),i=n,l=n.next}if(l!==null||v!==void 0){for(var D=v===void 0?[]:pe(v);l!==null;)D.push(l),l=l.next;var C=D.length;if(C>0){var ge=u&ve&&b===0?t:null;if(o){for(s=0;s<C;s+=1)(ne=D[s].a)==null||ne.measure();for(s=0;s<C;s+=1)(oe=D[s].a)==null||oe.fix()}Ze(e,D,ge,g)}}o&&Ae(()=>{var se;if(d!==void 0)for(n of d)(se=n.a)==null||se.apply()}),ue.first=e.first&&e.first.e,ue.last=i&&i.e}function je(a,e,t,r){r&ee&&U(a.v,e),r&te?U(a.i,t):a.i=t}function be(a,e,t,r,u,f,o,c,b){var g=Z;try{var h=(b&ee)!==0,l=(b&Pe)===0,v=h?l?Ce(u):L(u):u,i=b&te?L(o):o,d={i,v,k:f,a:null,e:null,prev:t,next:r};return Z=d,d.e=_e(()=>c(a,v,i),S),d.e.prev=t&&t.e,d.e.next=r&&r.e,t===null?e.first=d:(t.next=d,t.e.next=d.e),r!==null&&(r.prev=d,r.e.prev=d.e),d}finally{Z=g}}function fe(a,e,t){for(var r=a.next?a.next.e.nodes_start:t,u=e?e.e.nodes_start:t,f=a.e.nodes_start;f!==r;){var o=Oe(f);u.before(f),f=o}}function F(a,e,t){e===null?a.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function et(){let a=ce(()=>Xe.get().root),e=L(H([]));const t=function(o){let c=A(a);for(const b in o)c=c.subDirectories[o[b]];return c};let r=ce(()=>t(A(e)));const u=function(o){let c=t(A(e));delete c.subDirectories[o]},f=function(o="New Folder"){let c=t(A(e));c.subDirectories[crypto.randomUUID().slice(0,8)]={name:o,subDirectories:{},pageIDs:[]}};return{get root(){return A(a)},get currentPath(){return A(e)},set currentPath(o){U(e,H(o))},get currentDirectory(){return A(r)},get getDirectory(){return t},get addDirectory(){return f},get deleteDirectory(){return u}}}const _=et();var Y,q;class tt{constructor(){V(this,Y,L(H({})));V(this,q,L(H([])));Le(()=>{})}get root(){return A(M(this,Y))}set root(e){U(M(this,Y),H(e))}get path(){return A(M(this,q))}set path(e){U(M(this,q),H(e))}uniqueFolderName(e,t){if(!e.folders||e.folders[t]===void 0)return t;let r=1;for(;e.folders[t+r]!==void 0;)r+=1;return`${t} (${r})`}getFolder(e){let t=this.root;for(let r=0;r<e.length;(r+=1)-1){if(!t.folders||t.folders[e[r]]===void 0)throw new Error("Cannot get folder, path is not valid!");t=t.folders[e[r]]}return t}newFolder(e="New Folder",t){let r=this.getFolder(t||this.path);r.folders||(r.folders={}),r.folders[this.uniqueFolderName(r,e)]={}}deleteFolder(e,t){let r=this.getFolder(t||this.path);if(!r.folders||r.folders[e]===void 0){console.warn("No folder to delete");return}delete r.folders[e]}newFile(e,t){let r=this.getFolder(t||this.path);r.ids||(r.ids=[]),r.ids.push(e)}deleteFile(e,t){let r=this.getFolder(t||this.path);!r.ids||r.ids.includes(e)===!1||(r.ids=r.ids.filter(u=>u!==e))}}Y=new WeakMap,q=new WeakMap;const rt=Symbol("folderStore"),at=()=>{const a=new tt;return Ue(rt,a)};var nt=()=>{Be()},ot=G('<p>/ <input type="text"></p>'),st=G('<p>/</p> <button class="svelte-2z9p5h"> </button>',1),lt=G('<div class="path svelte-2z9p5h"><p>📂</p> <input type="text"> <button class="open-subpath-button svelte-2z9p5h">Go</button> <button class="delete-subpath-button svelte-2z9p5h">❌</button></div>'),it=(a,e)=>Ke(Qe+"/"+e()+"/"),ut=G('<div class="page svelte-2z9p5h"><p>📄</p> <input type="text"> <button class="goto-page-button svelte-2z9p5h">Go</button> <button class="close-page-button svelte-2z9p5h">❌</button></div>'),ct=G('<header class="svelte-2z9p5h"><button class="logout-button svelte-2z9p5h">Logout</button> <button class="spellcheck-button svelte-2z9p5h"> </button> <button class="new-page-button svelte-2z9p5h">+📄</button> <button class="new-path-button svelte-2z9p5h">+📂</button></header> <main><div class="current-path svelte-2z9p5h"><button class="back-button svelte-2z9p5h">Back</button> <button class="home-button svelte-2z9p5h"> </button> <!></div> <section id="items" class="svelte-2z9p5h"></section> <p>All pages:</p> <!></main>',1);function Et(a,e){Ye(e,!0),at();const t=Je(),r=We();var u=ct(),f=Q(u),o=T(f);o.__click=[nt];var c=k(o,2);c.__click=()=>{t.spellcheck=!t.spellcheck};var b=T(c);N(c);var g=k(c,2);g.__click=()=>{const n=crypto.randomUUID().slice(0,8),s={title:"New Page",content:"",lastUpdated:Date.now()};r[n]=s,_.currentDirectory.pageIDs.push(n)};var h=k(g,2);h.__click=()=>{_.addDirectory("New")},N(f);var l=k(f,2),v=T(l),i=T(v);i.__click=()=>{_.currentPath.pop()};var d=k(i,2);d.__click=()=>{_.currentPath=[]};var x=T(d);N(d);var I=k(d,2);j(I,17,()=>_.currentPath,$,(n,s,P)=>{var z=De(),p=Q(z);Ge(p,()=>P===_.currentPath.length-1,E=>{var m=ot(),D=k(T(m));J(D),N(m),W(D,()=>_.currentDirectory.name,C=>_.currentDirectory.name=C),R(E,m)},E=>{var m=st(),D=k(Q(m),2);D.__click=()=>{_.currentPath=_.currentPath.slice(0,P+1)};var C=T(D);de(()=>X(C,_.getDirectory(_.currentPath.slice(0,P+1)).name)),N(D),R(E,m)}),R(n,z)}),N(v);var w=k(v,2);j(w,21,()=>Object.entries(_.currentDirectory.subDirectories),$,(n,s)=>{let P=()=>A(s)[0],z=()=>A(s)[1];var p=lt(),E=k(T(p),2);J(E);var m=k(E,2);m.__click=()=>{_.currentPath.push(P())};var D=k(m,2);D.__click=()=>{_.deleteDirectory(P())},N(p),W(E,()=>z().name,C=>z().name=C),R(n,p)}),N(w);var y=k(w,4);j(y,17,()=>Object.entries(r),$,(n,s)=>{let P=()=>A(s)[0],z=()=>A(s)[1];var p=ut(),E=k(T(p),2);J(E);var m=k(E,2);m.__click=[it,P];var D=k(m,2);D.__click=()=>delete r[P()],N(p),W(E,()=>z().title,C=>z().title=C),R(n,p)}),N(l),de(()=>{X(b,`Spellcheck: ${t.spellcheck??""}`),i.disabled=_.currentPath.length===0,X(x,_.root.name)}),R(a,u),qe()}Ve(["click"]);export{Et as component};
