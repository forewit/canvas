import{a as M,t as H,c as it}from"../chunks/disclose-version.CTURzmtL.js";import{b as vt,h as U,k as pt,o as _t,M as at,l as ft,r as j,i as $,s as X,c as L,m as nt,a as ot,p as dt,a4 as ht,B as tt,y as lt,a5 as bt,a6 as gt,$ as mt,x as Q,a7 as kt,a8 as yt,L as Dt,a9 as xt,d as zt,I as Et,g as Pt,A as P,aa as W,O as It,Z,a0 as q,P as wt,a1 as A,a3 as h,a2 as T}from"../chunks/runtime.D4DqS6tz.js";import{s as J}from"../chunks/render.BeBBQ2z7.js";import{i as At}from"../chunks/if.CiaBrdUu.js";import{r as B}from"../chunks/attributes.CM7B3mdt.js";import{d as Tt}from"../chunks/events.BUMyFP41.js";import{b as G}from"../chunks/input.Dd9l6VPK.js";import{u as F,p as C}from"../chunks/pagesState.svelte.BgdIMNhs.js";import{l as Nt}from"../chunks/authUtils.DwhJWTbG.js";import{g as st,b as ct}from"../chunks/entry.CakyYFX8.js";import{p as et}from"../chunks/proxy.DEl-fzJA.js";let K=null;function V(n,t){return t}function St(n,t,e,c){for(var _=[],v=t.length,a=0;a<v;a++)yt(t[a].e,_,!0);var s=v>0&&_.length===0&&e!==null;if(s){var f=e.parentNode;Dt(f),f.append(e),c.clear(),S(n,t[0].prev,t[v-1].next)}xt(_,()=>{for(var r=0;r<v;r++){var u=t[r];s||(c.delete(u.k),S(n,u.prev,u.next)),zt(u.e,!s)}})}function Y(n,t,e,c,_,v=null){var a=n,s={flags:t,items:new Map,first:null};U&&pt();var f=null;vt(()=>{var r=e(),u=_t(r)?r:r==null?[]:at(r),l=u.length;let p=!1;if(U){var b=a.data===ft;b!==(l===0)&&(a=j(),$(a),X(!1),p=!0)}if(U){for(var d=null,w,o=0;o<l;o++){if(L.nodeType===8&&L.data===Et){a=L,p=!0,X(!1);break}var E=u[o],O=c(E,o);w=ut(L,s,d,null,E,O,o,_,t),s.items.set(O,w),d=w}l>0&&$(j())}U||Mt(u,s,a,_,t,c),v!==null&&(l===0?f?nt(f):f=ot(()=>v(a)):f!==null&&dt(f,()=>{f=null})),p&&X(!0)}),U&&(a=L)}function Mt(n,t,e,c,_,v){var a=n.length,s=t.items,f=t.first,r=f,u,l=null,p=[],b=[],d,w,o,E;for(E=0;E<a;E+=1){if(d=n[E],w=v(d,E),o=s.get(w),o===void 0){var O=r?r.e.nodes_start:e;l=ut(O,t,l,l===null?t.first:l.next,d,w,E,c,_),s.set(w,l),p=[],b=[],r=l.next;continue}if(Ot(o,d,E),o.e.f&ht&&nt(o.e),o!==r){if(u!==void 0&&u.has(o)){if(p.length<b.length){var R=b[0],i;l=R.prev;var g=p[0],y=p[p.length-1];for(i=0;i<p.length;i+=1)rt(p[i],R,e);for(i=0;i<b.length;i+=1)u.delete(b[i]);S(t,g.prev,y.next),S(t,l,g),S(t,y,R),r=R,l=y,E-=1,p=[],b=[]}else u.delete(o),rt(o,r,e),S(t,o.prev,o.next),S(t,o,l===null?t.first:l.next),S(t,l,o),l=o;continue}for(p=[],b=[];r!==null&&r.k!==w;)(u??(u=new Set)).add(r),b.push(r),r=r.next;if(r===null)continue;o=r}p.push(o),l=o,r=o.next}if(r!==null||u!==void 0){for(var D=u===void 0?[]:at(u);r!==null;)D.push(r),r=r.next;var x=D.length;if(x>0){var k=null;St(t,D,k,s)}}tt.first=t.first&&t.first.e,tt.last=l&&l.e}function Ot(n,t,e,c){lt(n.v,t),n.i=e}function ut(n,t,e,c,_,v,a,s,f){var r=K;try{var u=(f&bt)!==0,l=(f&gt)===0,p=u?l?mt(_):Q(_):_,b=f&kt?Q(a):a,d={i:b,v:p,k:v,a:null,e:null,prev:e,next:c};return K=d,d.e=ot(()=>s(n,p,b),U),d.e.prev=e&&e.e,d.e.next=c&&c.e,e===null?t.first=d:(e.next=d,e.e.next=d.e),c!==null&&(c.prev=d,c.e.prev=d.e),d}finally{K=r}}function rt(n,t,e){for(var c=n.next?n.next.e.nodes_start:e,_=t?t.e.nodes_start:e,v=n.e.nodes_start;v!==c;){var a=Pt(v);_.before(v),v=a}}function S(n,t,e){t===null?n.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function Rt(){let n=W(()=>F.get().root),t=Q(et([]));const e=function(a){let s=P(n);for(const f in a)s=s.subDirectories[a[f]];return s};let c=W(()=>e(P(t)));const _=function(a){let s=e(P(t));delete s.subDirectories[a]},v=function(a="New Folder"){let s=e(P(t));s.subDirectories[crypto.randomUUID().slice(0,8)]={name:a,subDirectories:{},pageIDs:[]}};return{get root(){return P(n)},get currentPath(){return P(t)},set currentPath(a){lt(t,et(a))},get currentDirectory(){return P(c)},get getDirectory(){return e},get addDirectory(){return v},get deleteDirectory(){return _}}}const m=Rt();var Ut=()=>{Nt()},Ct=()=>{F.get().spellcheck=!F.get().spellcheck},Ht=H('<p>/ <input type="text"></p>'),Lt=H('<p>/</p> <button class="svelte-2z9p5h"> </button>',1),Bt=H('<div class="path svelte-2z9p5h"><p>📂</p> <input type="text"> <button class="open-subpath-button svelte-2z9p5h">Go</button> <button class="delete-subpath-button svelte-2z9p5h">❌</button></div>'),Gt=(n,t)=>st(ct+"/"+t()+"/"),Vt=(n,t)=>delete C.get()[t()],Yt=H('<div class="page svelte-2z9p5h"><p>📄</p> <input type="text"> <button class="goto-page-button svelte-2z9p5h">Go</button> <button class="close-page-button svelte-2z9p5h">❌</button></div>'),Ft=(n,t)=>st(ct+"/"+t()+"/"),Xt=(n,t)=>delete C.get()[t()],Zt=H('<div class="page svelte-2z9p5h"><p>📄</p> <input type="text"> <button class="goto-page-button svelte-2z9p5h">Go</button> <button class="close-page-button svelte-2z9p5h">❌</button></div>'),qt=H('<header class="svelte-2z9p5h"><button class="logout-button svelte-2z9p5h">Logout</button> <button class="spellcheck-button svelte-2z9p5h"> </button> <button class="new-page-button svelte-2z9p5h">+📄</button> <button class="new-path-button svelte-2z9p5h">+📂</button></header> <main><div class="current-path svelte-2z9p5h"><button class="back-button svelte-2z9p5h">Back</button> <button class="home-button svelte-2z9p5h"> </button> <!></div> <section id="items" class="svelte-2z9p5h"><!> <!></section> <br> <br> <p>All pages:</p> <!></main>',1);function oe(n,t){It(t,!0);let e=W(()=>{let i={};return m.currentDirectory.pageIDs.forEach(g=>{g in C.get()&&(i[g]=C.get()[g])}),i});var c=qt(),_=Z(c),v=A(_);v.__click=[Ut];var a=h(v,2);a.__click=[Ct];var s=A(a);q(()=>J(s,`Spellcheck: ${F.get().spellcheck??""}`)),T(a);var f=h(a,2);f.__click=()=>{const i=crypto.randomUUID().slice(0,8),g={title:"New Page",content:"",lastUpdated:Date.now()};C.get()[i]=g,m.currentDirectory.pageIDs.push(i)};var r=h(f,2);r.__click=()=>{m.addDirectory("New")},T(_);var u=h(_,2),l=A(u),p=A(l);p.__click=()=>{m.currentPath.pop()};var b=h(p,2);b.__click=()=>{m.currentPath=[]};var d=A(b);T(b);var w=h(b,2);Y(w,17,()=>m.currentPath,V,(i,g,y)=>{var D=it(),x=Z(D);At(x,()=>y===m.currentPath.length-1,k=>{var z=Ht(),I=h(A(z));B(I),T(z),G(I,()=>m.currentDirectory.name,N=>m.currentDirectory.name=N),M(k,z)},k=>{var z=Lt(),I=h(Z(z),2);I.__click=()=>{m.currentPath=m.currentPath.slice(0,y+1)};var N=A(I);q(()=>J(N,m.getDirectory(m.currentPath.slice(0,y+1)).name)),T(I),M(k,z)}),M(i,D)}),T(l);var o=h(l,2),E=A(o);Y(E,17,()=>Object.entries(m.currentDirectory.subDirectories),V,(i,g)=>{let y=()=>P(g)[0],D=()=>P(g)[1];var x=Bt(),k=h(A(x),2);B(k);var z=h(k,2);z.__click=()=>{m.currentPath.push(y())};var I=h(z,2);I.__click=()=>{m.deleteDirectory(y())},T(x),G(k,()=>D().name,N=>D().name=N),M(i,x)});var O=h(E,2);Y(O,17,()=>Object.entries(P(e)),V,(i,g)=>{let y=()=>P(g)[0],D=()=>P(g)[1];var x=Yt(),k=h(A(x),2);B(k);var z=h(k,2);z.__click=[Gt,y];var I=h(z,2);I.__click=[Vt,y],T(x),G(k,()=>D().title,N=>D().title=N),M(i,x)}),T(o);var R=h(o,8);Y(R,17,()=>Object.entries(C.get()),V,(i,g)=>{let y=()=>P(g)[0],D=()=>P(g)[1];var x=Zt(),k=h(A(x),2);B(k);var z=h(k,2);z.__click=[Ft,y];var I=h(z,2);I.__click=[Xt,y],T(x),G(k,()=>D().title,N=>D().title=N),M(i,x)}),T(u),q(()=>{p.disabled=m.currentPath.length===0,J(d,m.root.name)}),M(n,c),wt()}Tt(["click"]);export{oe as component};
